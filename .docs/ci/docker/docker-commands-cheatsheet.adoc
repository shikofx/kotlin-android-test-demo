= Урок 1.2: Шпаргалка по командам Docker и Docker Compose

Этот документ содержит список часто используемых команд для управления Docker-контейнерами и сервисами, определенными через Docker Compose.

== Команды Docker

Эти команды используются для прямого управления отдельными контейнерами, образами и другими ресурсами Docker.

[cols="1,2"]
|===
| Команда | Описание

| `sudo docker ps`
| Показать список запущенных контейнеров.

| `sudo docker ps -a`
| Показать список всех контейнеров (включая остановленные).

| `sudo docker images`
| Показать список всех образов, загруженных на машину.

| `sudo docker logs -f <id_or_name>`
| Просмотреть логи контейнера в реальном времени.

| `sudo docker exec -it <id_or_name> bash`
| Запустить интерактивную сессию (`bash`) внутри работающего контейнера.

| `sudo docker stop <id_or_name>`
| Остановить работающий контейнер.

| `sudo docker exec -it <id_or_name> grep 'Password:' /etc/gitlab/initial_root_password`
| Получить первоначальный пароль `root` для GitLab.

| `sudo docker start <id_or_name>`
| Запустить остановленный контейнер.

| `sudo docker rm <id_or_name>`
| Удалить остановленный контейнер.

| `sudo docker rmi <image_id_or_name>`
| Удалить образ.

| `sudo docker system prune -a --volumes`
| Удалить все неиспользуемые контейнеры, сети, образы и тома (volumes). *Осторожно!*
|===

=== Детальный разбор команды `docker exec`

Рассмотрим команду для получения пароля GitLab: `sudo docker exec -it <container_name> grep 'Password:' /etc/gitlab/initial_root_password`

Она состоит из следующих частей:

* `sudo`: Выполняет следующую за ней команду с правами суперпользователя (администратора). Это необходимо, так как Docker по умолчанию требует повышенных привилегий.
* `docker exec`: Это основная команда Docker, которая означает "выполнить (`execute`)" команду внутри уже запущенного контейнера.
* `-it`: Это комбинация двух флагов, которые почти всегда используются вместе:
** `-i` (`--interactive`): Оставляет стандартный поток ввода (`STDIN`) открытым. Это позволяет вам взаимодействовать с процессом внутри контейнера (например, вводить команды в `bash`).
** `-t` (`--tty`): Выделяет псевдотерминал (pseudo-TTY). Это, по сути, "подключает" ваш терминал к терминалу внутри контейнера, что необходимо для интерактивных сессий.
* `<container_name>`: Заполнитель (placeholder) для имени или ID вашего контейнера. Узнать его можно с помощью команды `sudo docker ps`.
* `grep 'Password:' /etc/gitlab/initial_root_password`: Это та команда, которая будет выполнена *внутри контейнера GitLab*.
** `grep`: Стандартная утилита Linux для поиска текста.
** `'Password:'`: Текст, который `grep` будет искать.
** `/etc/gitlab/initial_root_password`: Файл внутри контейнера, где GitLab хранит сгенерированный пароль.

== Команды Docker Compose (v2)

Эти команды используются для управления многоконтейнерными приложениями, описанными в файле `docker-compose.yml`.

[cols="1,2"]
|===
| Команда | Описание

| `sudo docker compose up -d`
| Создать и запустить все сервисы в фоновом режиме.

| `sudo docker compose down`
| Остановить и удалить контейнеры, сети и тома, созданные `up`.

| `sudo docker compose ps`
| Показать статус контейнеров для текущего проекта.

| `sudo docker compose logs -f`
| Просмотреть логи всех сервисов в реальном времени.

| `sudo docker compose exec <service_name> bash`
| Запустить интерактивную сессию (`bash`) внутри контейнера конкретного сервиса.

| `sudo docker compose pull`
| Загрузить последние версии образов для всех сервисов.

| `sudo docker compose build`
| Пересобрать образы для сервисов.

| `sudo docker compose restart`
| Перезапустить все сервисы.
|===