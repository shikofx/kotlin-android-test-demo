= Урок 8: Решение проблемы "Connection refused" при подключении по SSH

Ошибка `ssh: connect to host <IP_адрес> port 22: Connection refused` — одна из самых частых при первоначальной настройке сервера. Она означает, что сервер доступен по сети, но активно отклоняет соединение на 22-й порт.

Вот как это исправить.

== Причина №1: Брандмауэр (Firewall) — наиболее вероятная

По умолчанию многие хостинг-провайдеры, включая Beget, блокируют все порты из соображений безопасности. Вам нужно вручную разрешить подключение к порту 22.

. *Войдите в панель управления Beget.*
. Найдите раздел управления вашим VPS/арендованным сервером.
. Найдите подраздел *"Брандмауэр"* или *"Сетевая защита"* (Firewall).
. Вам нужно добавить *разрешающее правило* для входящих подключений:
+
* *Протокол:* `TCP`
* *Порт:* `22`
* *Источник (IP-адрес):* Вы можете указать свой текущий IP-адрес для большей безопасности или `0.0.0.0/0`, чтобы разрешить подключения с любого адреса. Для начала можно использовать `0.0.0.0/0`.
. Сохраните и примените правило.

Подождите пару минут и попробуйте подключиться по SSH снова. В 90% случаев это решает проблему.

== Причина №2: Служба SSH не запущена на сервере

Если брандмауэр настроен правильно, но подключение все равно не проходит, возможно, на сервере не работает сама служба SSH.

. *Используйте веб-консоль.* В панели управления Beget найдите способ подключиться к серверу через веб-интерфейс (обычно называется "Консоль" или "VNC"). Это даст вам доступ к командной строке, даже если SSH не работает.
. *Проверьте статус службы SSH:*
+
[source,bash]
----
sudo systemctl status ssh
----
. Если служба неактивна (`inactive` или `dead`), запустите ее:
+
[source,bash]
----
sudo systemctl start ssh
----
. И включите ее автоматический запуск при загрузке сервера:
+
[source,bash]
----
sudo systemctl enable ssh
----

== Если ничего не помогает

Если вы проверили оба пункта, но проблема осталась, смело *обращайтесь в службу поддержки Beget*. Опишите им проблему и укажите IP-адрес вашего сервера. Они смогут проверить сетевые настройки на своем уровне.