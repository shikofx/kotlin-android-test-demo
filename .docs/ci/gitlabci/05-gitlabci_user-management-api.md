# Урок 5: Создание пользователей через API (продвинутый способ)

Помимо создания пользователей через веб-интерфейс, GitLab предоставляет мощный REST API для автоматизации этой и многих других задач. Этот подход идеален для написания скриптов и интеграции с другими системами.

Для выполнения запросов вам понадобится **Personal Access Token (PAT)** администратора.

## Шаг 1: Создание Personal Access Token (PAT)

1.  Войдите в GitLab под учетной записью администратора (`root`).
2.  Нажмите на свой аватар в правом верхнем углу и выберите **Edit profile**.
3.  В левом меню перейдите в раздел **Access Tokens**.
4.  Создайте новый токен:
    *   **Token name:** Придумайте осмысленное имя, например, `user-management-script`.
    *   **Expiration date:** (Опционально) Установите срок действия токена.
    *   **Select scopes:** Обязательно выберите скоуп **`api`**. Это даст токену полные права на чтение и запись через API.
5.  Нажмите **Create personal access token**.

**Важно:** GitLab покажет вам токен **только один раз**. Сразу же скопируйте его и сохраните в надежном месте. Если вы его потеряете, придется создавать новый.

## Шаг 2: Создание пользователя с помощью `curl`

Теперь, имея токен, вы можете отправить API-запрос на создание пользователя. Самый простой способ сделать это из командной строки — использовать утилиту `curl`.

### Пример создания пользователя с русским именем

Поле `name` поддерживает UTF-8, поэтому вы можете использовать кириллицу. Поле `username` при этом должно оставаться на латинице.

```bash
curl --request POST \
     --header "PRIVATE-TOKEN: <ВАШ_ACCESS_TOKEN>" \
     --header "Content-Type: application/json" \
     --data '{
       "email": "ivan.petrov@example.com",
       "password": "A_Very_Strong_Password123!",
       "username": "ivan.petrov",
       "name": "Иван Петров",
       "skip_confirmation": true
     }' \
     "https://gitlab.your_domain.xyz/api/v4/users"
```

### Разбор команды:
*   `--header "PRIVATE-TOKEN: <...>`: Здесь вы передаете ваш секретный токен для аутентификации.
*   `--data '{...}'`: Тело запроса в формате JSON с данными нового пользователя.
    *   `password`: Пароль должен соответствовать требованиям безопасности вашего GitLab-инстанса.
    *   `skip_confirmation: true`: Очень полезный флаг. Он создает пользователя сразу, без отправки письма с подтверждением на почту. Пользователь сможет войти с указанным паролем.
*   `"https://gitlab.your_domain.xyz/api/v4/users"`: URL-адрес (endpoint) для создания пользователей в вашем GitLab.

В случае успеха GitLab вернет JSON-объект с информацией о созданном пользователе. Этот метод является основой для любой автоматизации управления пользователями.