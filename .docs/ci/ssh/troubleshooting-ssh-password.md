# Урок 10: Решение проблемы "Требуется пароль" при подключении по SSH

Если при попытке клонировать репозиторий по SSH (`git clone git@...`) система запрашивает пароль, это означает, что аутентификация по SSH-ключу не удалась.

```bash
git clone git@gitlab.t366.xyz:shikofx/kotlin-android-test-demo.git
Cloning into 'kotlin-android-test-demo'...
git@gitlab.t366.xyz's password:
```

Запрос пароля (`git@... password:`) — это запасной механизм аутентификации, который срабатывает, когда сервер не может проверить вашу личность с помощью ключа.

Вот как это исправить.

## Причина №1: SSH-ключ не настроен на вашем компьютере

Сначала нужно убедиться, что у вас на локальной машине сгенерирована пара SSH-ключей (приватный и публичный).

1.  **Проверьте наличие ключей**
    Откройте терминал и выполните команду:
    ```bash
    ls -al ~/.ssh
    ```
    Если в выводе вы видите файлы с именами `id_rsa.pub`, `id_ed25519.pub` или `id_dsa.pub`, значит ключ у вас уже есть. Переходите к следующей причине.

2.  **Сгенерируйте новый SSH-ключ (если его нет)**
    Если папки `.ssh` или файлов с ключами нет, создайте новый ключ. Рекомендуется использовать алгоритм `ed25519`.
    ```bash
    ssh-keygen -t ed25519 -C "your_email@example.com"
    ```
    *   Замените `"your_email@example.com"` на ваш email.
    *   Система предложит указать файл для сохранения ключа. Просто нажмите **Enter**, чтобы согласиться с путём по умолчанию (`~/.ssh/id_ed25519`).
    *   Далее будет предложено ввести кодовую фразу (passphrase). Это дополнительный уровень защиты. Вы можете оставить поле пустым, нажав **Enter** дважды.

## Причина №2: Публичный ключ не добавлен в ваш профиль GitLab

Ваш сервер GitLab должен "знать" о вашем публичном ключе, чтобы доверять вашему компьютеру.

1.  **Скопируйте ваш публичный ключ**
    Выполните команду, чтобы скопировать содержимое вашего публичного ключа в буфер обмена.
    *   **Для macOS:**
        ```bash
        pbcopy < ~/.ssh/id_ed25519.pub
        ```
    *   **Для Linux (требуется `xclip`):**
        ```bash
        xclip -selection clipboard < ~/.ssh/id_ed25519.pub
        ```
    *   **Если команд выше нет,** просто откройте файл и скопируйте его содержимое вручную:
        ```bash
        cat ~/.ssh/id_ed25519.pub
        ```
        Скопируйте весь вывод, начиная с `ssh-ed25519` и заканчивая вашим email.

2.  **Добавьте ключ в GitLab**
    *   Откройте ваш GitLab в браузере.
    *   Нажмите на иконку вашего профиля в правом верхнем углу и выберите **Preferences** (Настройки).
    *   В меню слева перейдите в раздел **SSH Keys** (SSH-ключи).
    *   Вставьте скопированный ключ в поле **Key**.
    *   Дайте ключу понятное имя в поле **Title**, например, "Мой рабочий ноутбук".
    *   Нажмите кнопку **Add key**.

## Причина №3: SSH-агент не использует ваш ключ

Иногда, особенно если у вас несколько ключей, нужно явно указать, какой из них использовать.

1.  **Запустите SSH-агент** (если он еще не запущен):
    ```bash
    eval "$(ssh-agent -s)"
    ```

2.  **Добавьте ваш приватный ключ в SSH-агент:**
    ```bash
    ssh-add ~/.ssh/id_ed25519
    ```
    Если вы создавали ключ с другим именем, укажите путь к вашему приватному ключу.

## Финальная проверка

После выполнения этих шагов попробуйте снова клонировать репозиторий. Если проблема осталась, используйте команду с флагом `-v` для получения подробной информации о процессе подключения.

```bash
ssh -vT git@gitlab.t366.xyz
```
Внимательно посмотрите вывод. Он покажет, какие ключи предлагаются серверу и какой ответ от него приходит.