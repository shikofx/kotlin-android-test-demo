= Урок 5: Сохранение артефактов сборки

**Цель:** Сохранить собранный `app-debug.apk` как артефакт сборки, чтобы его можно было скачать, установить на устройство и протестировать вручную.

== Ключевые концепции

* *Артефакт (Artifact)*: Это файл или набор файлов, которые создаются в процессе выполнения workflow. GitHub Actions позволяет сохранять артефакты, связывая их с конкретным запуском пайплайна. Это идеально подходит для временного хранения сборок, отчетов или логов.
* *`actions/upload-artifact`*: Официальное действие от GitHub для загрузки и сохранения артефактов.

---

== Шаг 1: Обновление файла Workflow

После шага сборки APK добавим новый шаг, который будет загружать получившийся файл в артефакты.

[source,yaml,subs="callouts"]
----
name: SDT-DEMO CI

# ...

    steps:
      # ... предыдущие шаги ...

      - name: Build debug APK
        run: ./gradlew assembleDebug

      - name: Upload debug APK <1>
        uses: actions/upload-artifact@v4
        with:
          name: debug-apk <2>
          path: app/build/outputs/apk/debug/app-debug.apk <3>
----
<1> Используем готовый action `upload-artifact`.
<2> `name`: Имя артефакта, которое будет отображаться в UI.
<3> `path`: Путь к файлу, который мы хотим загрузить. Задача `assembleDebug` создает APK именно по этому пути.

=== Детальный разбор шага

Действие `upload-artifact` очень простое и мощное.

* *`with:`*: В этом блоке мы передаем параметры.
** *`name: debug-apk`*: Мы даем нашему артефакту понятное имя. Когда вы откроете страницу сборки, вы увидите секцию "Artifacts" с файлом `debug-apk`.
** *`path: app/build/outputs/apk/debug/app-debug.apk`*: Это самый важный параметр. Он указывает, какой именно файл нужно сохранить. В Android-проектах результаты сборки модуля (`app`) находятся внутри папки `build` этого модуля, поэтому полный путь начинается с `app/`.

== Шаг 2: Где найти артефакт?

После того как пайплайн успешно завершится:

. Перейдите на вкладку **Actions** в вашем репозитории.
. Выберите последний успешный запуск воркфлоу `SDT-DEMO CI`.
. На странице с результатами (Summary) вы увидите секцию **Artifacts**.
. В этой секции будет архив `debug-apk.zip`, который вы можете скачать. Внутри архива будет находиться ваш `app-debug.apk`.

Теперь после каждой сборки у вас будет готовый APK-файл, который можно передать тестировщикам или установить на свой телефон.

== Шаг 3: Что делает новый пайплайн?

Теперь наш пайплайн не только собирает приложение, но и делает результат доступным:

. Запускается на `push` или `pull_request`.
. Клонирует репозиторий.
. Устанавливает Java Development Kit (JDK) версии 17.
. Восстанавливает кэш Gradle.
. Дает файлу `gradlew` права на запуск.
. Выполняет команду `./gradlew assembleDebug`, которая собирает приложение.
. **(Новое)** Загружает собранный `app-debug.apk` в артефакты сборки.

---

В следующем шаге мы разберемся, как создавать полноценные релизы для публикации.
