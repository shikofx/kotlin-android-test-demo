= Урок 4: Сборка APK

**Цель:** Добавить в пайплайн финальный шаг для этого этапа — сборку debug-версии APK.

== Ключевые концепции

* *`assembleDebug`*: Стандартная Gradle-задача в Android-проектах, которая компилирует код, ресурсы и собирает из них установочный файл `app-debug.apk`. Это результат нашей работы на данный момент.

---

== Шаг 1: Обновление файла Workflow

После всех подготовительных шагов (установка Java, кэширование, выдача прав) мы наконец можем запустить саму сборку.

[source,yaml,subs="callouts"]
----
name: SDET-ANDROID-DEMO CI

on:
  push:
    branches: [ '**' ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    name: Build and Test
    runs-on: ubuntu-latest

    steps:
      # ... предыдущие шаги ...

      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      - name: Build debug APK <1>
        run: ./gradlew assembleDebug
----
<1> Запускаем сборку debug-версии приложения с помощью Gradle Wrapper.

=== Детальный разбор шага

==== `Build debug APK`

* *`run: ./gradlew assembleDebug`*: Запускаем саму сборку.
** `./gradlew` — это запуск скрипта Gradle Wrapper. Он автоматически скачает нужную версию Gradle (если ее нет в кэше) и запустит задачу.
** `assembleDebug` — это одна из стандартных задач Android Gradle Plugin. Она берет исходный код, ресурсы и зависимости и собирает из них готовый к установке APK-файл для отладки.

== Шаг 2: Что делает новый пайплайн?

Теперь наш пайплайн выполняет полный базовый цикл сборки:

. Запускается на `push` или `pull_request`.
. Клонирует репозиторий.
. Устанавливает Java Development Kit (JDK) версии 17.
. Восстанавливает кэш Gradle.
. Дает файлу `gradlew` права на запуск.
. **(Новое)** Выполняет команду `./gradlew assembleDebug`, которая собирает приложение.

После коммита этих изменений перейдите на вкладку **Actions**. Если все настроено правильно, пайплайн успешно завершится, а в логах шага "Build debug APK" вы увидите сообщение `BUILD SUCCESSFUL`. Это означает, что наш CI теперь может успешно собрать приложение.